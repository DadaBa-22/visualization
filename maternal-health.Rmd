---
title: "Maternal Risk Project"
author: "FREDRICK SARFO"
date: "2023-06-03"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You 

```{r}

```
## PREDICTING MATERNAL HEALTH RISK
Maternal:relating to a mother, especially during pregnancy or shortly after childbirth. Maternal health refers to the health of women during pregnancy, childbirth and the postnatal period. 

Each stage should be a positive experience, ensuring women and their babies reach their full potential for health and well-being. 

Although important progress has been made in the last two decades, about 287 000 women died during and following pregnancy and childbirth in 2020. This number is unacceptably high.

The most common direct causes of maternal injury and death are excessive blood loss, infection, high blood pressure, unsafe abortion, and obstructed labour, as well as indirect causes such as anemia, malaria, and heart disease. 

Most maternal deaths are preventable with timely management by a skilled health professional working in a supportive environment. 

Ending preventable maternal death must remain at the top of the global agenda. At the same time, simply surviving pregnancy and childbirth can never be the marker of successful maternal health care. It is critical to expand efforts reducing maternal injury and disability to promote health and well-being.

Every pregnancy and birth is unique. Addressing inequalities that affect health outcomes, especially sexual and reproductive health and rights and gender, is fundamental to ensuring all women have access to respectful and high-quality maternity care.
For this reason it is important to predict the maternal risk of every lady or woman
so that the require preventive measures will be put in place. 

This project will use these variables
Age: Age in years when a woman is pregnant.
• SystolicBP: Upper value of Blood Pressure in mmHg, another significant attribute during pregnancy.
• DiastolicBP: Lower value of Blood Pressure in mmHg, another significant attribute during pregnancy.
• BS: Blood glucose levels is in terms of a molar concentration, mmol/L.
• HeartRate: A normal resting heart rate in beats per minute.
• Risk Level: Predicted Risk Intensity Level during pregnancy considering the previous attribute.

 ### IMPORTING THE THE REQUIRE PACKAGES
```{r}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(lubridate)
```
### IMPORTING THE DATA INTO R MARKDOWN
```{r}
maternal_risk <-read_csv("C:/Users/DaDaBa/Downloads/Maternal_Risk.csv")
maternal_risk
```
## Verify to see if our data imported correctly

```{r}
colnames(maternal_risk)
```


```{r}
str(maternal_risk)
```

```{r}
head(maternal_risk, n=10)
```

```{r}
tail(maternal_risk)
```


```{r}
nrow(maternal_risk)
ncol(maternal_risk)
```
```{r}
sum(is.na(maternal_risk))
```

```{r}
## Now we convert risk level into a factor since is a categorical variable 
Risklevel <- as.factor(maternal_risk$RiskLevel)
head(risklevel)
```

### EXPLORATORY DATA ANALYSIS (EDA)

```{r}
summary(maternal_risk)
```


```{r}
table(Risklevel)
addmargins(table(Risklevel))
```


```{r}
ggplot(maternal_risk, aes(x = SystolicBP, y = BodyTemp)) + 
  geom_point(col = "blue")
```

```{r}
ggplot(maternal_risk, aes(x = DiastolicBP, y =  SystolicBP)) + 
  geom_point(col = "blue")
```


```{r}
ggplot(maternal_risk, aes(x = Age, y = BodyTemp)) + 
  geom_point(col = "blue")
```


```{r}
ggplot(maternal_risk, aes(x = BodyTemp, y = SystolicBP)) + 
  geom_point(col = "blue")
```


```{r}
ggplot(maternal_risk, aes(x = Age, y = SystolicBP)) + 
  geom_point(col = "blue")
```


```{r}
ggplot(maternal_risk, aes(x = RiskLevel)) + 
  geom_bar(col = "blue", fill = "indianred")
```


```{r}
library(corrplot)
correlation <- cor(maternal_risk%>% select(where(is.numeric)))
corrplot(correlation, method = "color", order = "hclust", addCoef.col = "black")
```


```{r}
pairs(correlation, cex = 1)
```

### CREATING THE CONFUSION MATRIX
```{r}
# Make reusable Confusion Matrix function
my_confusion_matrix <- function(cf_table) {
  true_positive <- cf_table[4]
  true_negative <- cf_table[1]
  false_positive <- cf_table[2]
  false_negative <- cf_table[3]
  accuracy <- (true_positive + true_negative) / (true_positive + true_negative + false_positive + false_negative)
  sensitivity_recall <- true_positive / (true_positive + false_negative) 
  specificity_selectivity <- true_negative / (true_negative + false_positive)
  precision <- true_positive / (true_positive + false_positive) 
  neg_pred_value <- true_negative/(true_negative + false_negative)
  print(cf_table)
  my_list <- list(sprintf("%1.0f = True Positive (TP), Hit", true_positive),
                  sprintf("%1.0f = True Negative (TN), Rejection", true_negative),
                  sprintf("%1.0f = False Positive (FP), Type 1 Error", false_positive),
                  sprintf("%1.0f = False Negative (FN), Type 2 Error", false_negative),
                  sprintf("%1.4f = Accuracy (TP+TN/(TP+TN+FP+FN))", accuracy), 
                  sprintf("%1.4f = Sensitivity, Recall, Hit Rate, True Positive Rate (How many positives did the model get right? TP/(TP+FN))", sensitivity_recall),
                  sprintf("%1.4f = Specificity, Selectivity, True Negative Rate (How many negatives did the model get right? TN/(TN+FP))", specificity_selectivity),                   
                  sprintf("%1.4f = Precision, Positive Predictive Value (How good are the model's positive predictions? TP/(TP+FP))", precision),
                  sprintf("%1.4f = Negative Predictive Value (How good are the model's negative predictions? TN/(TN+FN)", neg_pred_value)
  )
  return(my_list)
}
```


```{r}
library(caret)
library(jtools)
library(class)
```


```{r}
set.seed(77)
partition <- caret::createDataPartition(y = maternal_risk$RiskLevel, p = 0.75, list = F)
train_data <- maternal_risk[partition,]
test_data <- maternal_risk[-partition,]
```


```{r}
print(nrow(test_data)/(nrow(test_data)+nrow(train_data)))
```
```{r}
nrow(train_data)/(nrow(test_data)+nrow(train_data))
```


```{r}
nrow(train_data)
nrow(test_data)
```


```{r}
Null <-glm(as.factor(RiskLevel) ~ 1, family = binomial(link = logit), data = train_data)
Null
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```

